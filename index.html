<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Character Sheet Fixes</title>
    <style>
        /* --- General Theme Styles (Dark Mode) --- */
        body {
            background-color: #121212;
            color: #e0e0e0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            justify-content: center;
            padding-top: 50px;
        }

        .sheet-container {
            width: 100%;
            max-width: 800px;
            background-color: #1e1e1e;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
        }

        h2 {
            border-bottom: 1px solid #333;
            padding-bottom: 0.5rem;
            margin-bottom: 1.5rem;
            color: #aaa;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* --- Input Group Styling --- */
        .row {
            display: flex;
            gap: 20px;
            margin-bottom: 2rem;
            align-items: flex-end; /* Aligns inputs with buttons nicely */
            flex-wrap: wrap;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        label {
            font-size: 0.75rem;
            font-weight: bold;
            color: #888;
            text-transform: uppercase;
        }

        /* Standard Input Styling */
        input {
            background-color: #2c2c2c;
            border: 1px solid #444;
            border-radius: 4px;
            padding: 10px;
            color: white;
            font-size: 1rem;
            outline: none;
            transition: border-color 0.2s;
        }

        input:focus {
            border-color: #666;
        }

        /* --- FIX #3: Proficiency Bonus Alignment --- */
        /* By giving Level and Prof Bonus the same wrapper class, they align perfectly */
        .stat-small {
            width: 80px;
        }
        
        .stat-readonly {
            background-color: transparent; /* Makes it look like just text, but keeps alignment */
            border: 1px solid transparent;
            font-weight: bold;
            font-size: 1.2rem;
            color: #fff;
            padding-left: 0;
        }

        /* --- FIX #2: Spell Slots Width --- */
        /* This class forces the input to be narrow, overriding any global 'width: 100%' */
        .spell-slot-input {
            width: 60px !important; 
            text-align: center;
        }

        /* --- FIX #1: Damage Box Styling --- */
        .hp-section {
            display: flex;
            align-items: flex-end;
            gap: 10px;
            background: #252525;
            padding: 15px;
            border-radius: 6px;
            border: 1px solid #333;
        }

        .btn-damage {
            background-color: #8b0000;
            color: white;
            border: none;
            padding: 11px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            text-transform: uppercase;
            font-size: 0.8rem;
        }

        .btn-damage:hover {
            background-color: #a50000;
        }

        /* Helper colors for HP inputs */
        .hp-input { width: 80px; text-align: center; }
        #tempHP { color: #5dade2; border-color: #2e86c1; } /* Blue for Temp */
        #currentHP { color: #ec7063; } /* Red tint for HP */

    </style>
</head>
<body>

<div class="sheet-container">

    <h2>Character Stats</h2>
    <div class="row">
        <div class="input-group">
            <label for="charLevel">Level</label>
            <input type="number" id="charLevel" class="stat-small" value="1" min="1" max="20" oninput="updateProficiency()">
        </div>

        <div class="input-group">
            <label for="profBonus">Prof. Bonus</label>
            <input type="text" id="profBonus" class="stat-small stat-readonly" value="+2" readonly tabindex="-1">
        </div>
    </div>


    <h2>Health Status</h2>
    <div class="row">
        
        <div class="input-group">
            <label>Current HP</label>
            <input type="number" id="currentHP" class="hp-input" value="25">
        </div>

        <div class="input-group">
            <label>Temp HP</label>
            <input type="number" id="tempHP" class="hp-input" value="5">
        </div>

        <div class="hp-section">
            <div class="input-group">
                <label>Incoming Dmg</label>
                <input type="number" id="damageInput" placeholder="0" style="width: 100px;">
            </div>
            <button class="btn-damage" onclick="applyDamage()">Apply Damage</button>
        </div>
    </div>


    <h2>Spell Slots</h2>
    <div class="row">
        <div class="input-group">
            <label>1st Level</label>
            <input type="number" class="spell-slot-input" value="4">
        </div>

        <div class="input-group">
            <label>2nd Level</label>
            <input type="number" class="spell-slot-input" value="2">
        </div>
        
        <div class="input-group">
            <label>3rd Level</label>
            <input type="number" class="spell-slot-input" value="0">
        </div>
    </div>

</div>

<script>
    /* --- LOGIC: Auto-Calculate Proficiency --- */
    function updateProficiency() {
        const levelInput = document.getElementById('charLevel');
        const profOutput = document.getElementById('profBonus');
        
        let level = parseInt(levelInput.value);
        
        // Basic validation
        if (isNaN(level) || level < 1) level = 1;
        
        // Formula: Ceil(Level / 4) + 1
        const bonus = Math.ceil(level / 4) + 1;
        
        profOutput.value = "+" + bonus;
    }

    /* --- LOGIC: Damage Calculation (Temp HP Priority) --- */
    function applyDamage() {
        const damageInput = document.getElementById('damageInput');
        const tempHpInput = document.getElementById('tempHP');
        const currentHpInput = document.getElementById('currentHP');

        let damage = parseInt(damageInput.value) || 0;
        let tempHP = parseInt(tempHpInput.value) || 0;
        let currentHP = parseInt(currentHpInput.value) || 0;

        if (damage <= 0) return; // Don't process negative/zero damage

        // Step 1: Deduct from Temp HP
        if (tempHP > 0) {
            if (damage >= tempHP) {
                damage -= tempHP; // Remaining damage spills over
                tempHP = 0;       // Temp HP depleted
            } else {
                tempHP -= damage; // Temp HP absorbs all damage
                damage = 0;       // No damage left for Current HP
            }
        }

        // Step 2: Deduct remaining damage from Current HP
        currentHP -= damage;

        // Update Inputs
        tempHpInput.value = tempHP;
        currentHpInput.value = currentHP;

        // Clear the damage box for next turn
        damageInput.value = '';
        damageInput.focus(); // Keep focus for quick typing
    }

    // Initialize Proficiency on load just in case
    window.onload = updateProficiency;
</script>

</body>
</html>
